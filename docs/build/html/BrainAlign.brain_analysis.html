<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>BrainAlign.brain_analysis package &mdash; BrainAlign 0.1 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            BrainAlign
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <!-- Local TOC -->
              <div class="local-toc"><ul>
<li><a class="reference internal" href="#">BrainAlign.brain_analysis package</a><ul>
<li><a class="reference internal" href="#subpackages">Subpackages</a></li>
<li><a class="reference internal" href="#submodules">Submodules</a></li>
<li><a class="reference internal" href="#module-BrainAlign.brain_analysis.analysis">BrainAlign.brain_analysis.analysis module</a><ul>
<li><a class="reference internal" href="#BrainAlign.brain_analysis.analysis.align_cross_species"><code class="docutils literal notranslate"><span class="pre">align_cross_species()</span></code></a></li>
<li><a class="reference internal" href="#BrainAlign.brain_analysis.analysis.analysis_expression"><code class="docutils literal notranslate"><span class="pre">analysis_expression()</span></code></a></li>
<li><a class="reference internal" href="#BrainAlign.brain_analysis.analysis.brain_region_classfier"><code class="docutils literal notranslate"><span class="pre">brain_region_classfier()</span></code></a></li>
<li><a class="reference internal" href="#BrainAlign.brain_analysis.analysis.cross_evaluation_aligment"><code class="docutils literal notranslate"><span class="pre">cross_evaluation_aligment()</span></code></a></li>
<li><a class="reference internal" href="#BrainAlign.brain_analysis.analysis.cross_evaluation_aligment_cluster"><code class="docutils literal notranslate"><span class="pre">cross_evaluation_aligment_cluster()</span></code></a></li>
<li><a class="reference internal" href="#BrainAlign.brain_analysis.analysis.cross_evaluation_aligment_seperate"><code class="docutils literal notranslate"><span class="pre">cross_evaluation_aligment_seperate()</span></code></a></li>
<li><a class="reference internal" href="#BrainAlign.brain_analysis.analysis.cross_species_binary_clustering"><code class="docutils literal notranslate"><span class="pre">cross_species_binary_clustering()</span></code></a></li>
<li><a class="reference internal" href="#BrainAlign.brain_analysis.analysis.cross_species_genes_clustering"><code class="docutils literal notranslate"><span class="pre">cross_species_genes_clustering()</span></code></a></li>
<li><a class="reference internal" href="#BrainAlign.brain_analysis.analysis.genes_homo_random_corr"><code class="docutils literal notranslate"><span class="pre">genes_homo_random_corr()</span></code></a></li>
<li><a class="reference internal" href="#BrainAlign.brain_analysis.analysis.genes_homo_random_distance"><code class="docutils literal notranslate"><span class="pre">genes_homo_random_distance()</span></code></a></li>
<li><a class="reference internal" href="#BrainAlign.brain_analysis.analysis.get_center"><code class="docutils literal notranslate"><span class="pre">get_center()</span></code></a></li>
<li><a class="reference internal" href="#BrainAlign.brain_analysis.analysis.get_homologous_rate"><code class="docutils literal notranslate"><span class="pre">get_homologous_rate()</span></code></a></li>
<li><a class="reference internal" href="#BrainAlign.brain_analysis.analysis.homo_corr"><code class="docutils literal notranslate"><span class="pre">homo_corr()</span></code></a></li>
<li><a class="reference internal" href="#BrainAlign.brain_analysis.analysis.homo_corr_umap"><code class="docutils literal notranslate"><span class="pre">homo_corr_umap()</span></code></a></li>
<li><a class="reference internal" href="#BrainAlign.brain_analysis.analysis.identify_markergene"><code class="docutils literal notranslate"><span class="pre">identify_markergene()</span></code></a></li>
<li><a class="reference internal" href="#BrainAlign.brain_analysis.analysis.load_came_embeddings"><code class="docutils literal notranslate"><span class="pre">load_came_embeddings()</span></code></a></li>
<li><a class="reference internal" href="#BrainAlign.brain_analysis.analysis.load_heco_embeddings"><code class="docutils literal notranslate"><span class="pre">load_heco_embeddings()</span></code></a></li>
<li><a class="reference internal" href="#BrainAlign.brain_analysis.analysis.load_homo_genes"><code class="docutils literal notranslate"><span class="pre">load_homo_genes()</span></code></a></li>
<li><a class="reference internal" href="#BrainAlign.brain_analysis.analysis.load_srrsc_embeddings"><code class="docutils literal notranslate"><span class="pre">load_srrsc_embeddings()</span></code></a></li>
<li><a class="reference internal" href="#BrainAlign.brain_analysis.analysis.plot_homo_random"><code class="docutils literal notranslate"><span class="pre">plot_homo_random()</span></code></a></li>
<li><a class="reference internal" href="#BrainAlign.brain_analysis.analysis.random_corr"><code class="docutils literal notranslate"><span class="pre">random_corr()</span></code></a></li>
<li><a class="reference internal" href="#BrainAlign.brain_analysis.analysis.random_corr_umap"><code class="docutils literal notranslate"><span class="pre">random_corr_umap()</span></code></a></li>
<li><a class="reference internal" href="#BrainAlign.brain_analysis.analysis.spatial_alignment"><code class="docutils literal notranslate"><span class="pre">spatial_alignment()</span></code></a></li>
<li><a class="reference internal" href="#BrainAlign.brain_analysis.analysis.spatial_alignment_mouse"><code class="docutils literal notranslate"><span class="pre">spatial_alignment_mouse()</span></code></a></li>
<li><a class="reference internal" href="#BrainAlign.brain_analysis.analysis.transform_embedding"><code class="docutils literal notranslate"><span class="pre">transform_embedding()</span></code></a></li>
<li><a class="reference internal" href="#BrainAlign.brain_analysis.analysis.ttest_homo_random"><code class="docutils literal notranslate"><span class="pre">ttest_homo_random()</span></code></a></li>
<li><a class="reference internal" href="#BrainAlign.brain_analysis.analysis.umap_genes_seperate"><code class="docutils literal notranslate"><span class="pre">umap_genes_seperate()</span></code></a></li>
<li><a class="reference internal" href="#BrainAlign.brain_analysis.analysis.umap_seperate"><code class="docutils literal notranslate"><span class="pre">umap_seperate()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-BrainAlign.brain_analysis.analysis_main">BrainAlign.brain_analysis.analysis_main module</a><ul>
<li><a class="reference internal" href="#BrainAlign.brain_analysis.analysis_main.alignment_STs"><code class="docutils literal notranslate"><span class="pre">alignment_STs()</span></code></a></li>
<li><a class="reference internal" href="#BrainAlign.brain_analysis.analysis_main.alignment_STs_analysis"><code class="docutils literal notranslate"><span class="pre">alignment_STs_analysis</span></code></a><ul>
<li><a class="reference internal" href="#BrainAlign.brain_analysis.analysis_main.alignment_STs_analysis.experiment_1_cross_species_clustering"><code class="docutils literal notranslate"><span class="pre">alignment_STs_analysis.experiment_1_cross_species_clustering()</span></code></a></li>
<li><a class="reference internal" href="#BrainAlign.brain_analysis.analysis_main.alignment_STs_analysis.experiment_2_umap_evaluation"><code class="docutils literal notranslate"><span class="pre">alignment_STs_analysis.experiment_2_umap_evaluation()</span></code></a></li>
<li><a class="reference internal" href="#BrainAlign.brain_analysis.analysis_main.alignment_STs_analysis.experiment_3_homo_random"><code class="docutils literal notranslate"><span class="pre">alignment_STs_analysis.experiment_3_homo_random()</span></code></a></li>
<li><a class="reference internal" href="#BrainAlign.brain_analysis.analysis_main.alignment_STs_analysis.experiment_4_cross_species_genes_analysis"><code class="docutils literal notranslate"><span class="pre">alignment_STs_analysis.experiment_4_cross_species_genes_analysis()</span></code></a></li>
<li><a class="reference internal" href="#BrainAlign.brain_analysis.analysis_main.alignment_STs_analysis.experiment_5_genes_homo_random"><code class="docutils literal notranslate"><span class="pre">alignment_STs_analysis.experiment_5_genes_homo_random()</span></code></a></li>
<li><a class="reference internal" href="#BrainAlign.brain_analysis.analysis_main.alignment_STs_analysis.experiment_6_brain_region_classfier"><code class="docutils literal notranslate"><span class="pre">alignment_STs_analysis.experiment_6_brain_region_classfier()</span></code></a></li>
<li><a class="reference internal" href="#BrainAlign.brain_analysis.analysis_main.alignment_STs_analysis.experiment_7_align_cross_species"><code class="docutils literal notranslate"><span class="pre">alignment_STs_analysis.experiment_7_align_cross_species()</span></code></a></li>
<li><a class="reference internal" href="#BrainAlign.brain_analysis.analysis_main.alignment_STs_analysis.experiment_8_cross_evaluation_aligment_cluster"><code class="docutils literal notranslate"><span class="pre">alignment_STs_analysis.experiment_8_cross_evaluation_aligment_cluster()</span></code></a></li>
<li><a class="reference internal" href="#BrainAlign.brain_analysis.analysis_main.alignment_STs_analysis.forward"><code class="docutils literal notranslate"><span class="pre">alignment_STs_analysis.forward()</span></code></a></li>
<li><a class="reference internal" href="#BrainAlign.brain_analysis.analysis_main.alignment_STs_analysis.genes_homo_random_distance"><code class="docutils literal notranslate"><span class="pre">alignment_STs_analysis.genes_homo_random_distance()</span></code></a></li>
<li><a class="reference internal" href="#BrainAlign.brain_analysis.analysis_main.alignment_STs_analysis.homo_corr"><code class="docutils literal notranslate"><span class="pre">alignment_STs_analysis.homo_corr()</span></code></a></li>
<li><a class="reference internal" href="#BrainAlign.brain_analysis.analysis_main.alignment_STs_analysis.init_data"><code class="docutils literal notranslate"><span class="pre">alignment_STs_analysis.init_data()</span></code></a></li>
<li><a class="reference internal" href="#BrainAlign.brain_analysis.analysis_main.alignment_STs_analysis.plot_homo_random"><code class="docutils literal notranslate"><span class="pre">alignment_STs_analysis.plot_homo_random()</span></code></a></li>
<li><a class="reference internal" href="#BrainAlign.brain_analysis.analysis_main.alignment_STs_analysis.random_corr"><code class="docutils literal notranslate"><span class="pre">alignment_STs_analysis.random_corr()</span></code></a></li>
<li><a class="reference internal" href="#BrainAlign.brain_analysis.analysis_main.alignment_STs_analysis.ttest_homo_random"><code class="docutils literal notranslate"><span class="pre">alignment_STs_analysis.ttest_homo_random()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#BrainAlign.brain_analysis.analysis_main.anatomical_STs_analysis"><code class="docutils literal notranslate"><span class="pre">anatomical_STs_analysis</span></code></a><ul>
<li><a class="reference internal" href="#BrainAlign.brain_analysis.analysis_main.anatomical_STs_analysis.experiment_1_palette_comparison"><code class="docutils literal notranslate"><span class="pre">anatomical_STs_analysis.experiment_1_palette_comparison()</span></code></a></li>
<li><a class="reference internal" href="#BrainAlign.brain_analysis.analysis_main.anatomical_STs_analysis.experiment_2_spatial_alignment_specie1"><code class="docutils literal notranslate"><span class="pre">anatomical_STs_analysis.experiment_2_spatial_alignment_specie1()</span></code></a></li>
<li><a class="reference internal" href="#BrainAlign.brain_analysis.analysis_main.anatomical_STs_analysis.experiment_2_spatial_alignment_specie2"><code class="docutils literal notranslate"><span class="pre">anatomical_STs_analysis.experiment_2_spatial_alignment_specie2()</span></code></a></li>
<li><a class="reference internal" href="#BrainAlign.brain_analysis.analysis_main.anatomical_STs_analysis.forward"><code class="docutils literal notranslate"><span class="pre">anatomical_STs_analysis.forward()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#BrainAlign.brain_analysis.analysis_main.anatomical_STs_analysis_fun"><code class="docutils literal notranslate"><span class="pre">anatomical_STs_analysis_fun()</span></code></a></li>
<li><a class="reference internal" href="#BrainAlign.brain_analysis.analysis_main.gene_comparison"><code class="docutils literal notranslate"><span class="pre">gene_comparison()</span></code></a></li>
<li><a class="reference internal" href="#BrainAlign.brain_analysis.analysis_main.local_region_analysis"><code class="docutils literal notranslate"><span class="pre">local_region_analysis</span></code></a><ul>
<li><a class="reference internal" href="#BrainAlign.brain_analysis.analysis_main.local_region_analysis.experiment_1_neocortex_analysis"><code class="docutils literal notranslate"><span class="pre">local_region_analysis.experiment_1_neocortex_analysis()</span></code></a></li>
<li><a class="reference internal" href="#BrainAlign.brain_analysis.analysis_main.local_region_analysis.forward"><code class="docutils literal notranslate"><span class="pre">local_region_analysis.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-BrainAlign.brain_analysis.analysis_utils">BrainAlign.brain_analysis.analysis_utils module</a><ul>
<li><a class="reference internal" href="#BrainAlign.brain_analysis.analysis_utils.average_expression"><code class="docutils literal notranslate"><span class="pre">average_expression()</span></code></a></li>
<li><a class="reference internal" href="#BrainAlign.brain_analysis.analysis_utils.gene_module_abstract_graph"><code class="docutils literal notranslate"><span class="pre">gene_module_abstract_graph()</span></code></a></li>
<li><a class="reference internal" href="#BrainAlign.brain_analysis.analysis_utils.get_common_special_gene_list"><code class="docutils literal notranslate"><span class="pre">get_common_special_gene_list()</span></code></a></li>
<li><a class="reference internal" href="#BrainAlign.brain_analysis.analysis_utils.get_expression_group"><code class="docutils literal notranslate"><span class="pre">get_expression_group()</span></code></a></li>
<li><a class="reference internal" href="#BrainAlign.brain_analysis.analysis_utils.get_homologous_gene_list"><code class="docutils literal notranslate"><span class="pre">get_homologous_gene_list()</span></code></a></li>
<li><a class="reference internal" href="#BrainAlign.brain_analysis.analysis_utils.get_homologous_mat"><code class="docutils literal notranslate"><span class="pre">get_homologous_mat()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-BrainAlign.brain_analysis.data_utils">BrainAlign.brain_analysis.data_utils module</a><ul>
<li><a class="reference internal" href="#BrainAlign.brain_analysis.data_utils.corr2_coeff"><code class="docutils literal notranslate"><span class="pre">corr2_coeff()</span></code></a></li>
<li><a class="reference internal" href="#BrainAlign.brain_analysis.data_utils.generate_correlation_map"><code class="docutils literal notranslate"><span class="pre">generate_correlation_map()</span></code></a></li>
<li><a class="reference internal" href="#BrainAlign.brain_analysis.data_utils.num_zero_rows"><code class="docutils literal notranslate"><span class="pre">num_zero_rows()</span></code></a></li>
<li><a class="reference internal" href="#BrainAlign.brain_analysis.data_utils.plot_marker_selection_TSNE_embedding"><code class="docutils literal notranslate"><span class="pre">plot_marker_selection_TSNE_embedding()</span></code></a></li>
<li><a class="reference internal" href="#BrainAlign.brain_analysis.data_utils.plot_marker_selection_umap"><code class="docutils literal notranslate"><span class="pre">plot_marker_selection_umap()</span></code></a></li>
<li><a class="reference internal" href="#BrainAlign.brain_analysis.data_utils.plot_marker_selection_umap_embedding"><code class="docutils literal notranslate"><span class="pre">plot_marker_selection_umap_embedding()</span></code></a></li>
<li><a class="reference internal" href="#BrainAlign.brain_analysis.data_utils.threshold_array"><code class="docutils literal notranslate"><span class="pre">threshold_array()</span></code></a></li>
<li><a class="reference internal" href="#BrainAlign.brain_analysis.data_utils.threshold_array_nonzero"><code class="docutils literal notranslate"><span class="pre">threshold_array_nonzero()</span></code></a></li>
<li><a class="reference internal" href="#BrainAlign.brain_analysis.data_utils.threshold_quantile"><code class="docutils literal notranslate"><span class="pre">threshold_quantile()</span></code></a></li>
<li><a class="reference internal" href="#BrainAlign.brain_analysis.data_utils.threshold_std"><code class="docutils literal notranslate"><span class="pre">threshold_std()</span></code></a></li>
<li><a class="reference internal" href="#BrainAlign.brain_analysis.data_utils.threshold_top"><code class="docutils literal notranslate"><span class="pre">threshold_top()</span></code></a></li>
<li><a class="reference internal" href="#BrainAlign.brain_analysis.data_utils.train_test_val_split"><code class="docutils literal notranslate"><span class="pre">train_test_val_split()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-BrainAlign.brain_analysis.metrics">BrainAlign.brain_analysis.metrics module</a></li>
<li><a class="reference internal" href="#module-BrainAlign.brain_analysis.pipeline">BrainAlign.brain_analysis.pipeline module</a><ul>
<li><a class="reference internal" href="#BrainAlign.brain_analysis.pipeline.load_embeddings_came"><code class="docutils literal notranslate"><span class="pre">load_embeddings_came()</span></code></a></li>
<li><a class="reference internal" href="#BrainAlign.brain_analysis.pipeline.load_gene_embedding"><code class="docutils literal notranslate"><span class="pre">load_gene_embedding()</span></code></a></li>
<li><a class="reference internal" href="#BrainAlign.brain_analysis.pipeline.load_sample_embedding_concat"><code class="docutils literal notranslate"><span class="pre">load_sample_embedding_concat()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-BrainAlign.brain_analysis.process">BrainAlign.brain_analysis.process module</a><ul>
<li><a class="reference internal" href="#BrainAlign.brain_analysis.process.get_heco_input"><code class="docutils literal notranslate"><span class="pre">get_heco_input()</span></code></a></li>
<li><a class="reference internal" href="#BrainAlign.brain_analysis.process.get_neighbor"><code class="docutils literal notranslate"><span class="pre">get_neighbor()</span></code></a></li>
<li><a class="reference internal" href="#BrainAlign.brain_analysis.process.get_positive_sample"><code class="docutils literal notranslate"><span class="pre">get_positive_sample()</span></code></a></li>
<li><a class="reference internal" href="#BrainAlign.brain_analysis.process.get_spatial_relation"><code class="docutils literal notranslate"><span class="pre">get_spatial_relation()</span></code></a></li>
<li><a class="reference internal" href="#BrainAlign.brain_analysis.process.get_srrsc_input"><code class="docutils literal notranslate"><span class="pre">get_srrsc_input()</span></code></a></li>
<li><a class="reference internal" href="#BrainAlign.brain_analysis.process.highly_variable_HVGs"><code class="docutils literal notranslate"><span class="pre">highly_variable_HVGs()</span></code></a></li>
<li><a class="reference internal" href="#BrainAlign.brain_analysis.process.load_embedding"><code class="docutils literal notranslate"><span class="pre">load_embedding()</span></code></a></li>
<li><a class="reference internal" href="#BrainAlign.brain_analysis.process.load_gene_embedding"><code class="docutils literal notranslate"><span class="pre">load_gene_embedding()</span></code></a></li>
<li><a class="reference internal" href="#BrainAlign.brain_analysis.process.load_sample_embedding"><code class="docutils literal notranslate"><span class="pre">load_sample_embedding()</span></code></a></li>
<li><a class="reference internal" href="#BrainAlign.brain_analysis.process.load_sample_label"><code class="docutils literal notranslate"><span class="pre">load_sample_label()</span></code></a></li>
<li><a class="reference internal" href="#BrainAlign.brain_analysis.process.normalize_before_pruning"><code class="docutils literal notranslate"><span class="pre">normalize_before_pruning()</span></code></a></li>
<li><a class="reference internal" href="#BrainAlign.brain_analysis.process.normalize_default"><code class="docutils literal notranslate"><span class="pre">normalize_default()</span></code></a></li>
<li><a class="reference internal" href="#BrainAlign.brain_analysis.process.select_deg"><code class="docutils literal notranslate"><span class="pre">select_deg()</span></code></a></li>
<li><a class="reference internal" href="#BrainAlign.brain_analysis.process.test_interation"><code class="docutils literal notranslate"><span class="pre">test_interation()</span></code></a></li>
<li><a class="reference internal" href="#BrainAlign.brain_analysis.process.test_normalize"><code class="docutils literal notranslate"><span class="pre">test_normalize()</span></code></a></li>
<li><a class="reference internal" href="#BrainAlign.brain_analysis.process.test_pruning"><code class="docutils literal notranslate"><span class="pre">test_pruning()</span></code></a></li>
<li><a class="reference internal" href="#BrainAlign.brain_analysis.process.transform_pca_embedding"><code class="docutils literal notranslate"><span class="pre">transform_pca_embedding()</span></code></a></li>
<li><a class="reference internal" href="#BrainAlign.brain_analysis.process.transform_pca_embedding_np"><code class="docutils literal notranslate"><span class="pre">transform_pca_embedding_np()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-BrainAlign.brain_analysis">Module contents</a></li>
</ul>
</li>
</ul>
</div>
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">BrainAlign</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">BrainAlign.brain_analysis package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/BrainAlign.brain_analysis.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="brainalign-brain-analysis-package">
<h1>BrainAlign.brain_analysis package<a class="headerlink" href="#brainalign-brain-analysis-package" title="Permalink to this heading"></a></h1>
<section id="subpackages">
<h2>Subpackages<a class="headerlink" href="#subpackages" title="Permalink to this heading"></a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="BrainAlign.brain_analysis.configs.html">BrainAlign.brain_analysis.configs package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="BrainAlign.brain_analysis.configs.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="BrainAlign.brain_analysis.configs.html#module-BrainAlign.brain_analysis.configs.came_config_binary">BrainAlign.brain_analysis.configs.came_config_binary module</a></li>
<li class="toctree-l2"><a class="reference internal" href="BrainAlign.brain_analysis.configs.html#module-BrainAlign.brain_analysis.configs.heco_config">BrainAlign.brain_analysis.configs.heco_config module</a></li>
<li class="toctree-l2"><a class="reference internal" href="BrainAlign.brain_analysis.configs.html#module-BrainAlign.brain_analysis.configs.heco_config_all">BrainAlign.brain_analysis.configs.heco_config_all module</a></li>
<li class="toctree-l2"><a class="reference internal" href="BrainAlign.brain_analysis.configs.html#module-BrainAlign.brain_analysis.configs.heco_config_binary">BrainAlign.brain_analysis.configs.heco_config_binary module</a></li>
<li class="toctree-l2"><a class="reference internal" href="BrainAlign.brain_analysis.configs.html#module-BrainAlign.brain_analysis.configs.heco_config_binary_2020sa">BrainAlign.brain_analysis.configs.heco_config_binary_2020sa module</a></li>
<li class="toctree-l2"><a class="reference internal" href="BrainAlign.brain_analysis.configs.html#module-BrainAlign.brain_analysis.configs.heco_config_three_2020sa">BrainAlign.brain_analysis.configs.heco_config_three_2020sa module</a></li>
<li class="toctree-l2"><a class="reference internal" href="BrainAlign.brain_analysis.configs.html#module-BrainAlign.brain_analysis.configs.sr_rsc_config_binary">BrainAlign.brain_analysis.configs.sr_rsc_config_binary module</a></li>
<li class="toctree-l2"><a class="reference internal" href="BrainAlign.brain_analysis.configs.html#module-BrainAlign.brain_analysis.configs">Module contents</a></li>
</ul>
</li>
</ul>
</div>
</section>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this heading"></a></h2>
</section>
<section id="module-BrainAlign.brain_analysis.analysis">
<span id="brainalign-brain-analysis-analysis-module"></span><h2>BrainAlign.brain_analysis.analysis module<a class="headerlink" href="#module-BrainAlign.brain_analysis.analysis" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="BrainAlign.brain_analysis.analysis.align_cross_species">
<span class="sig-prename descclassname"><span class="pre">BrainAlign.brain_analysis.analysis.</span></span><span class="sig-name descname"><span class="pre">align_cross_species</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BrainAlign.brain_analysis.analysis.align_cross_species" title="Permalink to this definition"></a></dt>
<dd><p>Step 1: Compute average embedding of every region in two species, use two dict to store;
Step 2: Compute similarity matrix, use np array to store;
Step 3: Heatmap.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="BrainAlign.brain_analysis.analysis.analysis_expression">
<span class="sig-prename descclassname"><span class="pre">BrainAlign.brain_analysis.analysis.</span></span><span class="sig-name descname"><span class="pre">analysis_expression</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BrainAlign.brain_analysis.analysis.analysis_expression" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="BrainAlign.brain_analysis.analysis.brain_region_classfier">
<span class="sig-prename descclassname"><span class="pre">BrainAlign.brain_analysis.analysis.</span></span><span class="sig-name descname"><span class="pre">brain_region_classfier</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BrainAlign.brain_analysis.analysis.brain_region_classfier" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="BrainAlign.brain_analysis.analysis.cross_evaluation_aligment">
<span class="sig-prename descclassname"><span class="pre">BrainAlign.brain_analysis.analysis.</span></span><span class="sig-name descname"><span class="pre">cross_evaluation_aligment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BrainAlign.brain_analysis.analysis.cross_evaluation_aligment" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="BrainAlign.brain_analysis.analysis.cross_evaluation_aligment_cluster">
<span class="sig-prename descclassname"><span class="pre">BrainAlign.brain_analysis.analysis.</span></span><span class="sig-name descname"><span class="pre">cross_evaluation_aligment_cluster</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BrainAlign.brain_analysis.analysis.cross_evaluation_aligment_cluster" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="BrainAlign.brain_analysis.analysis.cross_evaluation_aligment_seperate">
<span class="sig-prename descclassname"><span class="pre">BrainAlign.brain_analysis.analysis.</span></span><span class="sig-name descname"><span class="pre">cross_evaluation_aligment_seperate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BrainAlign.brain_analysis.analysis.cross_evaluation_aligment_seperate" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="BrainAlign.brain_analysis.analysis.cross_species_binary_clustering">
<span class="sig-prename descclassname"><span class="pre">BrainAlign.brain_analysis.analysis.</span></span><span class="sig-name descname"><span class="pre">cross_species_binary_clustering</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BrainAlign.brain_analysis.analysis.cross_species_binary_clustering" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="BrainAlign.brain_analysis.analysis.cross_species_genes_clustering">
<span class="sig-prename descclassname"><span class="pre">BrainAlign.brain_analysis.analysis.</span></span><span class="sig-name descname"><span class="pre">cross_species_genes_clustering</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BrainAlign.brain_analysis.analysis.cross_species_genes_clustering" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="BrainAlign.brain_analysis.analysis.genes_homo_random_corr">
<span class="sig-prename descclassname"><span class="pre">BrainAlign.brain_analysis.analysis.</span></span><span class="sig-name descname"><span class="pre">genes_homo_random_corr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BrainAlign.brain_analysis.analysis.genes_homo_random_corr" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="BrainAlign.brain_analysis.analysis.genes_homo_random_distance">
<span class="sig-prename descclassname"><span class="pre">BrainAlign.brain_analysis.analysis.</span></span><span class="sig-name descname"><span class="pre">genes_homo_random_distance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'euclidean'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BrainAlign.brain_analysis.analysis.genes_homo_random_distance" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="BrainAlign.brain_analysis.analysis.get_center">
<span class="sig-prename descclassname"><span class="pre">BrainAlign.brain_analysis.analysis.</span></span><span class="sig-name descname"><span class="pre">get_center</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">points</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BrainAlign.brain_analysis.analysis.get_center" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="BrainAlign.brain_analysis.analysis.get_homologous_rate">
<span class="sig-prename descclassname"><span class="pre">BrainAlign.brain_analysis.analysis.</span></span><span class="sig-name descname"><span class="pre">get_homologous_rate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">max_subset_num</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mouse_64_labels_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">human_88_labels_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mouse_overlap_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">human_overlap_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">homo_region_mouse_human_dict</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BrainAlign.brain_analysis.analysis.get_homologous_rate" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="BrainAlign.brain_analysis.analysis.homo_corr">
<span class="sig-prename descclassname"><span class="pre">BrainAlign.brain_analysis.analysis.</span></span><span class="sig-name descname"><span class="pre">homo_corr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BrainAlign.brain_analysis.analysis.homo_corr" title="Permalink to this definition"></a></dt>
<dd><p>Step 1: Compute average embedding of every region in two species, use two dict to store;
Step 2: Compute similarity matrix, use np array to store;
Step 3: Heatmap.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="BrainAlign.brain_analysis.analysis.homo_corr_umap">
<span class="sig-prename descclassname"><span class="pre">BrainAlign.brain_analysis.analysis.</span></span><span class="sig-name descname"><span class="pre">homo_corr_umap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BrainAlign.brain_analysis.analysis.homo_corr_umap" title="Permalink to this definition"></a></dt>
<dd><p>Step 1: Compute average embedding of every region in two species, use two dict to store;
Step 2: Compute similarity matrix, use np array to store;
Step 3: Heatmap.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="BrainAlign.brain_analysis.analysis.identify_markergene">
<span class="sig-prename descclassname"><span class="pre">BrainAlign.brain_analysis.analysis.</span></span><span class="sig-name descname"><span class="pre">identify_markergene</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BrainAlign.brain_analysis.analysis.identify_markergene" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="BrainAlign.brain_analysis.analysis.load_came_embeddings">
<span class="sig-prename descclassname"><span class="pre">BrainAlign.brain_analysis.analysis.</span></span><span class="sig-name descname"><span class="pre">load_came_embeddings</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BrainAlign.brain_analysis.analysis.load_came_embeddings" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="BrainAlign.brain_analysis.analysis.load_heco_embeddings">
<span class="sig-prename descclassname"><span class="pre">BrainAlign.brain_analysis.analysis.</span></span><span class="sig-name descname"><span class="pre">load_heco_embeddings</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BrainAlign.brain_analysis.analysis.load_heco_embeddings" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="BrainAlign.brain_analysis.analysis.load_homo_genes">
<span class="sig-prename descclassname"><span class="pre">BrainAlign.brain_analysis.analysis.</span></span><span class="sig-name descname"><span class="pre">load_homo_genes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BrainAlign.brain_analysis.analysis.load_homo_genes" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="BrainAlign.brain_analysis.analysis.load_srrsc_embeddings">
<span class="sig-prename descclassname"><span class="pre">BrainAlign.brain_analysis.analysis.</span></span><span class="sig-name descname"><span class="pre">load_srrsc_embeddings</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BrainAlign.brain_analysis.analysis.load_srrsc_embeddings" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="BrainAlign.brain_analysis.analysis.plot_homo_random">
<span class="sig-prename descclassname"><span class="pre">BrainAlign.brain_analysis.analysis.</span></span><span class="sig-name descname"><span class="pre">plot_homo_random</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BrainAlign.brain_analysis.analysis.plot_homo_random" title="Permalink to this definition"></a></dt>
<dd><p>Step 1:load human and mouse cross expression data of homologous regions, and random regions
Step 2: plot bar, mean and std</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="BrainAlign.brain_analysis.analysis.random_corr">
<span class="sig-prename descclassname"><span class="pre">BrainAlign.brain_analysis.analysis.</span></span><span class="sig-name descname"><span class="pre">random_corr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BrainAlign.brain_analysis.analysis.random_corr" title="Permalink to this definition"></a></dt>
<dd><p>Step 1: Compute average embedding of every region in two species, use two dict to store;
Step 2: Compute similarity matrix, use np array to store;
Step 3: Heatmap.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="BrainAlign.brain_analysis.analysis.random_corr_umap">
<span class="sig-prename descclassname"><span class="pre">BrainAlign.brain_analysis.analysis.</span></span><span class="sig-name descname"><span class="pre">random_corr_umap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BrainAlign.brain_analysis.analysis.random_corr_umap" title="Permalink to this definition"></a></dt>
<dd><p>Step 1: Compute average embedding of every region in two species, use two dict to store;
Step 2: Compute similarity matrix, use np array to store;
Step 3: Heatmap.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="BrainAlign.brain_analysis.analysis.spatial_alignment">
<span class="sig-prename descclassname"><span class="pre">BrainAlign.brain_analysis.analysis.</span></span><span class="sig-name descname"><span class="pre">spatial_alignment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BrainAlign.brain_analysis.analysis.spatial_alignment" title="Permalink to this definition"></a></dt>
<dd><p>Step 1: Compute average embedding and position of every region in two species, use two dict to store;
Step 2: Compute distance between regions, select one-nearest neighbor of each region, compute correlations;
Step 3: plot Boxplot.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="BrainAlign.brain_analysis.analysis.spatial_alignment_mouse">
<span class="sig-prename descclassname"><span class="pre">BrainAlign.brain_analysis.analysis.</span></span><span class="sig-name descname"><span class="pre">spatial_alignment_mouse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BrainAlign.brain_analysis.analysis.spatial_alignment_mouse" title="Permalink to this definition"></a></dt>
<dd><p>Step 1: Compute average embedding and position of every region in two species, use two dict to store;
Step 2: Compute distance between regions, select one-nearest neighbor of each region, compute correlations;
Step 3: plot Boxplot.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="BrainAlign.brain_analysis.analysis.transform_embedding">
<span class="sig-prename descclassname"><span class="pre">BrainAlign.brain_analysis.analysis.</span></span><span class="sig-name descname"><span class="pre">transform_embedding</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Mat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">M_embedding</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BrainAlign.brain_analysis.analysis.transform_embedding" title="Permalink to this definition"></a></dt>
<dd><p>Add one in the  denominator to avoid infinite values</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="BrainAlign.brain_analysis.analysis.ttest_homo_random">
<span class="sig-prename descclassname"><span class="pre">BrainAlign.brain_analysis.analysis.</span></span><span class="sig-name descname"><span class="pre">ttest_homo_random</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BrainAlign.brain_analysis.analysis.ttest_homo_random" title="Permalink to this definition"></a></dt>
<dd><p>Step 1:load human and mouse cross expression data of homologous regions, and random regions
Step 2: plot bar, mean and std</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="BrainAlign.brain_analysis.analysis.umap_genes_seperate">
<span class="sig-prename descclassname"><span class="pre">BrainAlign.brain_analysis.analysis.</span></span><span class="sig-name descname"><span class="pre">umap_genes_seperate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BrainAlign.brain_analysis.analysis.umap_genes_seperate" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="BrainAlign.brain_analysis.analysis.umap_seperate">
<span class="sig-prename descclassname"><span class="pre">BrainAlign.brain_analysis.analysis.</span></span><span class="sig-name descname"><span class="pre">umap_seperate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BrainAlign.brain_analysis.analysis.umap_seperate" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-BrainAlign.brain_analysis.analysis_main">
<span id="brainalign-brain-analysis-analysis-main-module"></span><h2>BrainAlign.brain_analysis.analysis_main module<a class="headerlink" href="#module-BrainAlign.brain_analysis.analysis_main" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="BrainAlign.brain_analysis.analysis_main.alignment_STs">
<span class="sig-prename descclassname"><span class="pre">BrainAlign.brain_analysis.analysis_main.</span></span><span class="sig-name descname"><span class="pre">alignment_STs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BrainAlign.brain_analysis.analysis_main.alignment_STs" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="BrainAlign.brain_analysis.analysis_main.alignment_STs_analysis">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">BrainAlign.brain_analysis.analysis_main.</span></span><span class="sig-name descname"><span class="pre">alignment_STs_analysis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BrainAlign.brain_analysis.analysis_main.alignment_STs_analysis" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="BrainAlign.brain_analysis.analysis_main.alignment_STs_analysis.experiment_1_cross_species_clustering">
<span class="sig-name descname"><span class="pre">experiment_1_cross_species_clustering</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#BrainAlign.brain_analysis.analysis_main.alignment_STs_analysis.experiment_1_cross_species_clustering" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BrainAlign.brain_analysis.analysis_main.alignment_STs_analysis.experiment_2_umap_evaluation">
<span class="sig-name descname"><span class="pre">experiment_2_umap_evaluation</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#BrainAlign.brain_analysis.analysis_main.alignment_STs_analysis.experiment_2_umap_evaluation" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BrainAlign.brain_analysis.analysis_main.alignment_STs_analysis.experiment_3_homo_random">
<span class="sig-name descname"><span class="pre">experiment_3_homo_random</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#BrainAlign.brain_analysis.analysis_main.alignment_STs_analysis.experiment_3_homo_random" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BrainAlign.brain_analysis.analysis_main.alignment_STs_analysis.experiment_4_cross_species_genes_analysis">
<span class="sig-name descname"><span class="pre">experiment_4_cross_species_genes_analysis</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#BrainAlign.brain_analysis.analysis_main.alignment_STs_analysis.experiment_4_cross_species_genes_analysis" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BrainAlign.brain_analysis.analysis_main.alignment_STs_analysis.experiment_5_genes_homo_random">
<span class="sig-name descname"><span class="pre">experiment_5_genes_homo_random</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#BrainAlign.brain_analysis.analysis_main.alignment_STs_analysis.experiment_5_genes_homo_random" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BrainAlign.brain_analysis.analysis_main.alignment_STs_analysis.experiment_6_brain_region_classfier">
<span class="sig-name descname"><span class="pre">experiment_6_brain_region_classfier</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#BrainAlign.brain_analysis.analysis_main.alignment_STs_analysis.experiment_6_brain_region_classfier" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BrainAlign.brain_analysis.analysis_main.alignment_STs_analysis.experiment_7_align_cross_species">
<span class="sig-name descname"><span class="pre">experiment_7_align_cross_species</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#BrainAlign.brain_analysis.analysis_main.alignment_STs_analysis.experiment_7_align_cross_species" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BrainAlign.brain_analysis.analysis_main.alignment_STs_analysis.experiment_8_cross_evaluation_aligment_cluster">
<span class="sig-name descname"><span class="pre">experiment_8_cross_evaluation_aligment_cluster</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#BrainAlign.brain_analysis.analysis_main.alignment_STs_analysis.experiment_8_cross_evaluation_aligment_cluster" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BrainAlign.brain_analysis.analysis_main.alignment_STs_analysis.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#BrainAlign.brain_analysis.analysis_main.alignment_STs_analysis.forward" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BrainAlign.brain_analysis.analysis_main.alignment_STs_analysis.genes_homo_random_distance">
<span class="sig-name descname"><span class="pre">genes_homo_random_distance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">metric_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'euclidean'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BrainAlign.brain_analysis.analysis_main.alignment_STs_analysis.genes_homo_random_distance" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BrainAlign.brain_analysis.analysis_main.alignment_STs_analysis.homo_corr">
<span class="sig-name descname"><span class="pre">homo_corr</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#BrainAlign.brain_analysis.analysis_main.alignment_STs_analysis.homo_corr" title="Permalink to this definition"></a></dt>
<dd><p>Step 1: Compute average embedding of every region in two species, use two dict to store;
Step 2: Compute similarity matrix, use np array to store;
Step 3: Heatmap.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BrainAlign.brain_analysis.analysis_main.alignment_STs_analysis.init_data">
<span class="sig-name descname"><span class="pre">init_data</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#BrainAlign.brain_analysis.analysis_main.alignment_STs_analysis.init_data" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BrainAlign.brain_analysis.analysis_main.alignment_STs_analysis.plot_homo_random">
<span class="sig-name descname"><span class="pre">plot_homo_random</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#BrainAlign.brain_analysis.analysis_main.alignment_STs_analysis.plot_homo_random" title="Permalink to this definition"></a></dt>
<dd><p>Step 1:load human and mouse cross expression data of homologous regions, and random regions
Step 2: plot bar, mean and std</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BrainAlign.brain_analysis.analysis_main.alignment_STs_analysis.random_corr">
<span class="sig-name descname"><span class="pre">random_corr</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#BrainAlign.brain_analysis.analysis_main.alignment_STs_analysis.random_corr" title="Permalink to this definition"></a></dt>
<dd><p>Step 1: Compute average embedding of every region in two species, use two dict to store;
Step 2: Compute similarity matrix, use np array to store;
Step 3: Heatmap.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BrainAlign.brain_analysis.analysis_main.alignment_STs_analysis.ttest_homo_random">
<span class="sig-name descname"><span class="pre">ttest_homo_random</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#BrainAlign.brain_analysis.analysis_main.alignment_STs_analysis.ttest_homo_random" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="BrainAlign.brain_analysis.analysis_main.anatomical_STs_analysis">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">BrainAlign.brain_analysis.analysis_main.</span></span><span class="sig-name descname"><span class="pre">anatomical_STs_analysis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BrainAlign.brain_analysis.analysis_main.anatomical_STs_analysis" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="BrainAlign.brain_analysis.analysis_main.anatomical_STs_analysis.experiment_1_palette_comparison">
<span class="sig-name descname"><span class="pre">experiment_1_palette_comparison</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#BrainAlign.brain_analysis.analysis_main.anatomical_STs_analysis.experiment_1_palette_comparison" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BrainAlign.brain_analysis.analysis_main.anatomical_STs_analysis.experiment_2_spatial_alignment_specie1">
<span class="sig-name descname"><span class="pre">experiment_2_spatial_alignment_specie1</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#BrainAlign.brain_analysis.analysis_main.anatomical_STs_analysis.experiment_2_spatial_alignment_specie1" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BrainAlign.brain_analysis.analysis_main.anatomical_STs_analysis.experiment_2_spatial_alignment_specie2">
<span class="sig-name descname"><span class="pre">experiment_2_spatial_alignment_specie2</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#BrainAlign.brain_analysis.analysis_main.anatomical_STs_analysis.experiment_2_spatial_alignment_specie2" title="Permalink to this definition"></a></dt>
<dd><p>Step 1: Compute average embedding and position of every region in two species, use two dict to store;
Step 2: Compute distance between regions, select one-nearest neighbor of each region, compute correlations;
Step 3: plot Boxplot.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BrainAlign.brain_analysis.analysis_main.anatomical_STs_analysis.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#BrainAlign.brain_analysis.analysis_main.anatomical_STs_analysis.forward" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="BrainAlign.brain_analysis.analysis_main.anatomical_STs_analysis_fun">
<span class="sig-prename descclassname"><span class="pre">BrainAlign.brain_analysis.analysis_main.</span></span><span class="sig-name descname"><span class="pre">anatomical_STs_analysis_fun</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BrainAlign.brain_analysis.analysis_main.anatomical_STs_analysis_fun" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="BrainAlign.brain_analysis.analysis_main.gene_comparison">
<span class="sig-prename descclassname"><span class="pre">BrainAlign.brain_analysis.analysis_main.</span></span><span class="sig-name descname"><span class="pre">gene_comparison</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BrainAlign.brain_analysis.analysis_main.gene_comparison" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="BrainAlign.brain_analysis.analysis_main.local_region_analysis">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">BrainAlign.brain_analysis.analysis_main.</span></span><span class="sig-name descname"><span class="pre">local_region_analysis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BrainAlign.brain_analysis.analysis_main.local_region_analysis" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="BrainAlign.brain_analysis.analysis_main.local_region_analysis.experiment_1_neocortex_analysis">
<span class="sig-name descname"><span class="pre">experiment_1_neocortex_analysis</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#BrainAlign.brain_analysis.analysis_main.local_region_analysis.experiment_1_neocortex_analysis" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="BrainAlign.brain_analysis.analysis_main.local_region_analysis.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#BrainAlign.brain_analysis.analysis_main.local_region_analysis.forward" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-BrainAlign.brain_analysis.analysis_utils">
<span id="brainalign-brain-analysis-analysis-utils-module"></span><h2>BrainAlign.brain_analysis.analysis_utils module<a class="headerlink" href="#module-BrainAlign.brain_analysis.analysis_utils" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="BrainAlign.brain_analysis.analysis_utils.average_expression">
<span class="sig-prename descclassname"><span class="pre">BrainAlign.brain_analysis.analysis_utils.</span></span><span class="sig-name descname"><span class="pre">average_expression</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">AnnData</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">genes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span></span></span><a class="headerlink" href="#BrainAlign.brain_analysis.analysis_utils.average_expression" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="BrainAlign.brain_analysis.analysis_utils.gene_module_abstract_graph">
<span class="sig-prename descclassname"><span class="pre">BrainAlign.brain_analysis.analysis_utils.</span></span><span class="sig-name descname"><span class="pre">gene_module_abstract_graph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adata_gene_embedding</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig_format</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key_class</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resolution</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">umap_min_dist</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.85</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">umap_n_neighbors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BrainAlign.brain_analysis.analysis_utils.gene_module_abstract_graph" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="BrainAlign.brain_analysis.analysis_utils.get_common_special_gene_list">
<span class="sig-prename descclassname"><span class="pre">BrainAlign.brain_analysis.analysis_utils.</span></span><span class="sig-name descname"><span class="pre">get_common_special_gene_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gene_list_mouse</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gene_list_human</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gene_name_mouse_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gene_name_human_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mh_matrix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">corr_matrix</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BrainAlign.brain_analysis.analysis_utils.get_common_special_gene_list" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="BrainAlign.brain_analysis.analysis_utils.get_expression_group">
<span class="sig-prename descclassname"><span class="pre">BrainAlign.brain_analysis.analysis_utils.</span></span><span class="sig-name descname"><span class="pre">get_expression_group</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">groupby</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gene_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BrainAlign.brain_analysis.analysis_utils.get_expression_group" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="BrainAlign.brain_analysis.analysis_utils.get_homologous_gene_list">
<span class="sig-prename descclassname"><span class="pre">BrainAlign.brain_analysis.analysis_utils.</span></span><span class="sig-name descname"><span class="pre">get_homologous_gene_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gene_list_mouse</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gene_list_human</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gene_name_mouse_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gene_name_human_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">MH_mat</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BrainAlign.brain_analysis.analysis_utils.get_homologous_gene_list" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="BrainAlign.brain_analysis.analysis_utils.get_homologous_mat">
<span class="sig-prename descclassname"><span class="pre">BrainAlign.brain_analysis.analysis_utils.</span></span><span class="sig-name descname"><span class="pre">get_homologous_mat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gene_list_mouse</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gene_list_human</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">homologous_pair_mouse</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">homologous_pair_human</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BrainAlign.brain_analysis.analysis_utils.get_homologous_mat" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-BrainAlign.brain_analysis.data_utils">
<span id="brainalign-brain-analysis-data-utils-module"></span><h2>BrainAlign.brain_analysis.data_utils module<a class="headerlink" href="#module-BrainAlign.brain_analysis.data_utils" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="BrainAlign.brain_analysis.data_utils.corr2_coeff">
<span class="sig-prename descclassname"><span class="pre">BrainAlign.brain_analysis.data_utils.</span></span><span class="sig-name descname"><span class="pre">corr2_coeff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">B</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BrainAlign.brain_analysis.data_utils.corr2_coeff" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="BrainAlign.brain_analysis.data_utils.generate_correlation_map">
<span class="sig-prename descclassname"><span class="pre">BrainAlign.brain_analysis.data_utils.</span></span><span class="sig-name descname"><span class="pre">generate_correlation_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BrainAlign.brain_analysis.data_utils.generate_correlation_map" title="Permalink to this definition"></a></dt>
<dd><p>Correlate each n with each m.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>np.array</em>) – Shape N X T.</p></li>
<li><p><strong>y</strong> (<em>np.array</em>) – Shape M X T.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>N X M array in which each element is a correlation coefficient.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="BrainAlign.brain_analysis.data_utils.num_zero_rows">
<span class="sig-prename descclassname"><span class="pre">BrainAlign.brain_analysis.data_utils.</span></span><span class="sig-name descname"><span class="pre">num_zero_rows</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BrainAlign.brain_analysis.data_utils.num_zero_rows" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="BrainAlign.brain_analysis.data_utils.plot_marker_selection_TSNE_embedding">
<span class="sig-prename descclassname"><span class="pre">BrainAlign.brain_analysis.data_utils.</span></span><span class="sig-name descname"><span class="pre">plot_marker_selection_TSNE_embedding</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">embedding</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">markers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">perplexity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">40</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BrainAlign.brain_analysis.data_utils.plot_marker_selection_TSNE_embedding" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="BrainAlign.brain_analysis.data_utils.plot_marker_selection_umap">
<span class="sig-prename descclassname"><span class="pre">BrainAlign.brain_analysis.data_utils.</span></span><span class="sig-name descname"><span class="pre">plot_marker_selection_umap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">markers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">umap_neighbor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BrainAlign.brain_analysis.data_utils.plot_marker_selection_umap" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="BrainAlign.brain_analysis.data_utils.plot_marker_selection_umap_embedding">
<span class="sig-prename descclassname"><span class="pre">BrainAlign.brain_analysis.data_utils.</span></span><span class="sig-name descname"><span class="pre">plot_marker_selection_umap_embedding</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">embedding</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">markers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">umap_neighbor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BrainAlign.brain_analysis.data_utils.plot_marker_selection_umap_embedding" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="BrainAlign.brain_analysis.data_utils.threshold_array">
<span class="sig-prename descclassname"><span class="pre">BrainAlign.brain_analysis.data_utils.</span></span><span class="sig-name descname"><span class="pre">threshold_array</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BrainAlign.brain_analysis.data_utils.threshold_array" title="Permalink to this definition"></a></dt>
<dd><p>input: array row: sample, column: gene vector
output: a binary matrix
For each value in (i, j), the binary value = if(M_ij &gt; avg(column_j))</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="BrainAlign.brain_analysis.data_utils.threshold_array_nonzero">
<span class="sig-prename descclassname"><span class="pre">BrainAlign.brain_analysis.data_utils.</span></span><span class="sig-name descname"><span class="pre">threshold_array_nonzero</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BrainAlign.brain_analysis.data_utils.threshold_array_nonzero" title="Permalink to this definition"></a></dt>
<dd><p>input: array row: sample, column: gene vector
output: a binary matrix
For each value in (i, j), the binary value = if(M_ij &gt; avg(column_j))</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="BrainAlign.brain_analysis.data_utils.threshold_quantile">
<span class="sig-prename descclassname"><span class="pre">BrainAlign.brain_analysis.data_utils.</span></span><span class="sig-name descname"><span class="pre">threshold_quantile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quantile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.8</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BrainAlign.brain_analysis.data_utils.threshold_quantile" title="Permalink to this definition"></a></dt>
<dd><p>input: array row: sample, column: gene vector
output: a binary matrix
For each value in (i, j), the binary value = if(M_ij &gt; avg(column_j))</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="BrainAlign.brain_analysis.data_utils.threshold_std">
<span class="sig-prename descclassname"><span class="pre">BrainAlign.brain_analysis.data_utils.</span></span><span class="sig-name descname"><span class="pre">threshold_std</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">std_times</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BrainAlign.brain_analysis.data_utils.threshold_std" title="Permalink to this definition"></a></dt>
<dd><p>input: array row: sample, column: gene vector
output: a binary matrix</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="BrainAlign.brain_analysis.data_utils.threshold_top">
<span class="sig-prename descclassname"><span class="pre">BrainAlign.brain_analysis.data_utils.</span></span><span class="sig-name descname"><span class="pre">threshold_top</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">percent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BrainAlign.brain_analysis.data_utils.threshold_top" title="Permalink to this definition"></a></dt>
<dd><p>input: array row: sample, column: gene vector
output: a binary matrix
For each value in (i, j), the binary value = if(M_ij &gt; avg(column_j))</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="BrainAlign.brain_analysis.data_utils.train_test_val_split">
<span class="sig-prename descclassname"><span class="pre">BrainAlign.brain_analysis.data_utils.</span></span><span class="sig-name descname"><span class="pre">train_test_val_split</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_ratio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">validation_ratio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_ratio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BrainAlign.brain_analysis.data_utils.train_test_val_split" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-BrainAlign.brain_analysis.metrics">
<span id="brainalign-brain-analysis-metrics-module"></span><h2>BrainAlign.brain_analysis.metrics module<a class="headerlink" href="#module-BrainAlign.brain_analysis.metrics" title="Permalink to this heading"></a></h2>
</section>
<section id="module-BrainAlign.brain_analysis.pipeline">
<span id="brainalign-brain-analysis-pipeline-module"></span><h2>BrainAlign.brain_analysis.pipeline module<a class="headerlink" href="#module-BrainAlign.brain_analysis.pipeline" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="BrainAlign.brain_analysis.pipeline.load_embeddings_came">
<span class="sig-prename descclassname"><span class="pre">BrainAlign.brain_analysis.pipeline.</span></span><span class="sig-name descname"><span class="pre">load_embeddings_came</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BrainAlign.brain_analysis.pipeline.load_embeddings_came" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="BrainAlign.brain_analysis.pipeline.load_gene_embedding">
<span class="sig-prename descclassname"><span class="pre">BrainAlign.brain_analysis.pipeline.</span></span><span class="sig-name descname"><span class="pre">load_gene_embedding</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mouse_gene_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">human_gene_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cfg</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BrainAlign.brain_analysis.pipeline.load_gene_embedding" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="BrainAlign.brain_analysis.pipeline.load_sample_embedding_concat">
<span class="sig-prename descclassname"><span class="pre">BrainAlign.brain_analysis.pipeline.</span></span><span class="sig-name descname"><span class="pre">load_sample_embedding_concat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mouse_sample_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">human_sample_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cfg</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BrainAlign.brain_analysis.pipeline.load_sample_embedding_concat" title="Permalink to this definition"></a></dt>
<dd><p>Step 1: Compute average embedding of every region in two species, use two dict to store;
Step 2: Compute similarity matrix, use np array to store;
Step 3: Heatmap.</p>
</dd></dl>

</section>
<section id="module-BrainAlign.brain_analysis.process">
<span id="brainalign-brain-analysis-process-module"></span><h2>BrainAlign.brain_analysis.process module<a class="headerlink" href="#module-BrainAlign.brain_analysis.process" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="BrainAlign.brain_analysis.process.get_heco_input">
<span class="sig-prename descclassname"><span class="pre">BrainAlign.brain_analysis.process.</span></span><span class="sig-name descname"><span class="pre">get_heco_input</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BrainAlign.brain_analysis.process.get_heco_input" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="BrainAlign.brain_analysis.process.get_neighbor">
<span class="sig-prename descclassname"><span class="pre">BrainAlign.brain_analysis.process.</span></span><span class="sig-name descname"><span class="pre">get_neighbor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sm_</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cfg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_node_num</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neibor_node_num</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BrainAlign.brain_analysis.process.get_neighbor" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="BrainAlign.brain_analysis.process.get_positive_sample">
<span class="sig-prename descclassname"><span class="pre">BrainAlign.brain_analysis.process.</span></span><span class="sig-name descname"><span class="pre">get_positive_sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">meta_path_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_node</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BrainAlign.brain_analysis.process.get_positive_sample" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="BrainAlign.brain_analysis.process.get_spatial_relation">
<span class="sig-prename descclassname"><span class="pre">BrainAlign.brain_analysis.process.</span></span><span class="sig-name descname"><span class="pre">get_spatial_relation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BrainAlign.brain_analysis.process.get_spatial_relation" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="BrainAlign.brain_analysis.process.get_srrsc_input">
<span class="sig-prename descclassname"><span class="pre">BrainAlign.brain_analysis.process.</span></span><span class="sig-name descname"><span class="pre">get_srrsc_input</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BrainAlign.brain_analysis.process.get_srrsc_input" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="BrainAlign.brain_analysis.process.highly_variable_HVGs">
<span class="sig-prename descclassname"><span class="pre">BrainAlign.brain_analysis.process.</span></span><span class="sig-name descname"><span class="pre">highly_variable_HVGs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">_adata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cfg</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">hvg_kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BrainAlign.brain_analysis.process.highly_variable_HVGs" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="BrainAlign.brain_analysis.process.load_embedding">
<span class="sig-prename descclassname"><span class="pre">BrainAlign.brain_analysis.process.</span></span><span class="sig-name descname"><span class="pre">load_embedding</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BrainAlign.brain_analysis.process.load_embedding" title="Permalink to this definition"></a></dt>
<dd><ol class="arabic simple">
<li><p>Get graph G_mouse, G_human from CAME init data;</p></li>
</ol>
<p>2. Filter original expression data via G_mouse, G_human, acquire M_mouse, M_human;
3.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="BrainAlign.brain_analysis.process.load_gene_embedding">
<span class="sig-prename descclassname"><span class="pre">BrainAlign.brain_analysis.process.</span></span><span class="sig-name descname"><span class="pre">load_gene_embedding</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mouse_gene_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">human_gene_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cfg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BrainAlign.brain_analysis.process.load_gene_embedding" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="BrainAlign.brain_analysis.process.load_sample_embedding">
<span class="sig-prename descclassname"><span class="pre">BrainAlign.brain_analysis.process.</span></span><span class="sig-name descname"><span class="pre">load_sample_embedding</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mouse_sample_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">human_sample_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cfg</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BrainAlign.brain_analysis.process.load_sample_embedding" title="Permalink to this definition"></a></dt>
<dd><p>Step 1: Compute average embedding of every region in two species, use two dict to store;
Step 2: Compute similarity matrix, use np array to store;
Step 3: Heatmap.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="BrainAlign.brain_analysis.process.load_sample_label">
<span class="sig-prename descclassname"><span class="pre">BrainAlign.brain_analysis.process.</span></span><span class="sig-name descname"><span class="pre">load_sample_label</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mouse_region_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cfg</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BrainAlign.brain_analysis.process.load_sample_label" title="Permalink to this definition"></a></dt>
<dd><p>Step 1: Compute average embedding of every region in two species, use two dict to store;
Step 2: Compute similarity matrix, use np array to store;
Step 3: Heatmap.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="BrainAlign.brain_analysis.process.normalize_before_pruning">
<span class="sig-prename descclassname"><span class="pre">BrainAlign.brain_analysis.process.</span></span><span class="sig-name descname"><span class="pre">normalize_before_pruning</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_sum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_return</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BrainAlign.brain_analysis.process.normalize_before_pruning" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="BrainAlign.brain_analysis.process.normalize_default">
<span class="sig-prename descclassname"><span class="pre">BrainAlign.brain_analysis.process.</span></span><span class="sig-name descname"><span class="pre">normalize_default</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">AnnData</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_sum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">copy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_only</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_return</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BrainAlign.brain_analysis.process.normalize_default" title="Permalink to this definition"></a></dt>
<dd><p>Normalizing datasets with default settings (total-counts normalization
followed by log(x+1) transform).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>adata</strong> – <code class="docutils literal notranslate"><span class="pre">AnnData</span></code> object</p></li>
<li><p><strong>target_sum</strong> – scale factor of total-count normalization</p></li>
<li><p><strong>copy</strong> – whether to copy the dataset</p></li>
<li><p><strong>log_only</strong> – whether to skip the “total-counts normalization” and only perform
log(x+1) transform</p></li>
<li><p><strong>force_return</strong> – whether to return the data, even if changes are made for the
original object</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">AnnData</span></code> or None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="BrainAlign.brain_analysis.process.select_deg">
<span class="sig-prename descclassname"><span class="pre">BrainAlign.brain_analysis.process.</span></span><span class="sig-name descname"><span class="pre">select_deg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BrainAlign.brain_analysis.process.select_deg" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="BrainAlign.brain_analysis.process.test_interation">
<span class="sig-prename descclassname"><span class="pre">BrainAlign.brain_analysis.process.</span></span><span class="sig-name descname"><span class="pre">test_interation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BrainAlign.brain_analysis.process.test_interation" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="BrainAlign.brain_analysis.process.test_normalize">
<span class="sig-prename descclassname"><span class="pre">BrainAlign.brain_analysis.process.</span></span><span class="sig-name descname"><span class="pre">test_normalize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BrainAlign.brain_analysis.process.test_normalize" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="BrainAlign.brain_analysis.process.test_pruning">
<span class="sig-prename descclassname"><span class="pre">BrainAlign.brain_analysis.process.</span></span><span class="sig-name descname"><span class="pre">test_pruning</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BrainAlign.brain_analysis.process.test_pruning" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="BrainAlign.brain_analysis.process.transform_pca_embedding">
<span class="sig-prename descclassname"><span class="pre">BrainAlign.brain_analysis.process.</span></span><span class="sig-name descname"><span class="pre">transform_pca_embedding</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Mat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">M_embedding</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BrainAlign.brain_analysis.process.transform_pca_embedding" title="Permalink to this definition"></a></dt>
<dd><p>input:Mat, sample number * gene number
output: gene number * embedding dimension
M_embedding:
Add one in the  denominator to avoid infinite values</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="BrainAlign.brain_analysis.process.transform_pca_embedding_np">
<span class="sig-prename descclassname"><span class="pre">BrainAlign.brain_analysis.process.</span></span><span class="sig-name descname"><span class="pre">transform_pca_embedding_np</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Mat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">M_embedding</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#BrainAlign.brain_analysis.process.transform_pca_embedding_np" title="Permalink to this definition"></a></dt>
<dd><p>input:Mat, sample number * gene number
M_embedding:
Add one in the  denominator to avoid infinite values</p>
</dd></dl>

</section>
<section id="module-BrainAlign.brain_analysis">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-BrainAlign.brain_analysis" title="Permalink to this heading"></a></h2>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Biao Zhang.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>